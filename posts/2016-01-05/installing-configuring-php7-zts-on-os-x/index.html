<!doctype html><html lang="en"><head><meta charset="utf-8"><link rel="shortcut icon" href="/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="canonical" href="/posts/2016-01-05/installing-configuring-php7-zts-on-os-x" />

    <title data-react-helmet="true">Installing &amp; Configuring PHP7 w/ ZTS on OS X</title>
    
    
  <script>window.__NAVI_STATE__={"__navi__":{"requestDataWithoutState":{}}};</script><link href="/static/css/main.8ad86df6.chunk.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="BlogLayout_container__3WeFl"><div class="
        LoadingIndicator_LoadingIndicator__22gHk
        
        undefined
      "></div><header><h3 class="BlogLayout_title__6OZKV"><a href="/" context="[object Object]" class=" ">smddzcy | yet another dev</a></h3></header><main><article><header class="BlogPostLayout_header__2LB8S"><h1 class="BlogPostLayout_title__3g2FG"><a href="/posts/2016-01-05/installing-configuring-php7-zts-on-os-x" context="[object Object]" class=" ">Installing &amp; Configuring PHP7 w/ ZTS on OS X</a></h1><small><time dateTime="Mon, 04 Jan 2016 22:00:00 GMT">January 5, 2016</time> <!-- -->•<!-- --> <ul class="ArticleMeta_tags__VKe_V"><li><a href="/tags/php7" context="[object Object]" class=" ">php7</a></li><li><a href="/tags/os x" context="[object Object]" class=" ">os x</a></li><li><a href="/tags/tutorial" context="[object Object]" class=" ">tutorial</a></li><li><a href="/tags/configuration" context="[object Object]" class=" ">configuration</a></li><li><a href="/tags/installation" context="[object Object]" class=" ">installation</a></li></ul> <!-- -->•<!-- --> <span>☕️<!-- --> <!-- -->3<!-- --> min read</span></small></header><div class="BlogPostLayout_content__jzLFq"><div><p>There are two ways to build PHP. First way is the simplest and no-mess way, using <strong>Homebrew</strong> - or any equivalent <em>package manager</em> depending on your system. If you are not already familiar with package managers, I strongly suggest you to be.  They make lives easier for sure. The second way is the slow &amp; messy way; building it from scratch without any package manager. It may be slow and messy but actually, it gives you more options while building. This is my way of installing PHP on my servers, but on my personal computer; since I don’t have any deep specific requirements - and for simplicity too - I’ll be using and talking about the Homebrew way. I’ll publish a tutorial about this too, but now let’s start.</p><h2 id="installing">Installing</h2><p>First, update the Homebrew and get the required formulas - <em>formulas</em> are just packages, like those in aptitude. If you don’t have Homebrew yet, visit this page for installation and detailed usage: <a href="http://brew.sh" rel="nofollow noopener noreferrer" target="_blank" context="[object Object]" class=" ">http://brew.sh</a></p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">brew update <span class="token operator">&amp;&amp;</span> brew tap homebrew/php
</code></pre><p>See which versions of PHP we can have.</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">brew search php
</code></pre><p>There will be a long list. If you see something like &quot;<strong>homebrew/php/php70</strong>&quot; then it’s OK. Now let’s look at the options we have.</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">brew options php70
</code></pre><p>You can use any of these options while installing PHP, but do not forget to include <code>--with-thread-safety</code>, it is essential for threading extensions. Now start the installation</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">brew <span class="token function">install</span> php70 --with-thread-safety --with-homebrew-curl
</code></pre><p>After some time - brace yourself, it might take a little long - depending on your internet and Mac’s speed, installation finishes. Now install some extensions. My recommendations are here but you can find all the extensions by <code>brew search php70-</code></p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">brew <span class="token function">install</span> php70-opcache php70-mcrypt php70-pthreads php70-xdebug --build-from-source
brew <span class="token function">install</span> php70-memcached --build-from-source --HEAD
</code></pre><p>Installation is done, let’s continue with configuration.</p><h2 id="configuring">Configuring</h2><p>I start by adding PHP support in Apache. First you have to find the path to your httpd.conf file: (mostly it’ll be <code>/private/etc/apache2/httpd.conf</code>)</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">httpd -V <span class="token operator">|</span> <span class="token function">grep</span> SERVER\_CONFIG\_FILE
</code></pre><p>Open the file with a text editor, also with privileges otherwise you can’t make changes - use <code>sudo</code> for example.</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers=""><span class="token function">sudo</span> <span class="token function">nano</span> PATH-TO-YOUR-CONFIG
</code></pre><p>Add these at the end of the file</p><pre><code>LoadModule php7_module /usr/local/opt/php70/libexec/apache2/libphp7.so

&lt;FilesMatch .php<div id="root">gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
</code></pre><p>Then find this line</p><pre><code>DirectoryIndex index.html
</code></pre><p>and change with:</p><pre><code>DirectoryIndex index.php index.html
</code></pre><p>You can close the config file. Now let’s set up the <code>php.ini</code>. First make a link to the new <code>php.ini</code> file</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers=""><span class="token function">sudo</span> <span class="token function">mv</span> /etc/php.ini /etc/php.ini_old
<span class="token function">sudo</span> <span class="token function">ln</span> -s /usr/local/etc/php/7.0/php.ini /etc/php.ini
</code></pre><p><code>/etc</code> is the path to my .ini file. You can see yours by running:</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers="">php --ini
</code></pre><p>Then this file needs some configuration too. Find <code>;date.timezone =</code> and set your timezone. Mine is:</p><pre><code>date.timezone = &quot;Europe/Istanbul&quot;
</code></pre><p>Find <code>;opcache.enable</code>, <code>;opcache.enable_cli</code> and set them both to <code>1</code>, also delete the <code>;</code> (<em>semicolon</em>) prefixes. For detailed opcache settings, visit this page: <a href="https://www.scalingphpbook.com/best-zend-opcache-settings-tuning-config/" rel="nofollow noopener noreferrer" target="_blank" context="[object Object]" class=" ">https://www.scalingphpbook.com/best-zend-opcache-settings-tuning-config/</a></p><p>There are tons of options in the <code>php.ini</code> and <code>httpd.conf</code>, I can’t include them all here but I suggest you to make some research and find the best options that suit your case. After these, it should be all set. Open a new terminal window, fire up your server and check the PHP version. You can also see your installed extensions by running <code>php -m</code>.</p><pre><code class="language-bash" data-language="bash" data-highlighted-line-numbers=""><span class="token function">sudo</span> httpd -k restart
php -v
</code></pre><p><a href="http://localhost/smddzcy.com/wp-content/uploads/2016/01/php-7-version.png" rel="nofollow noopener noreferrer" target="_blank" context="[object Object]" class=" "><img src="http://localhost/smddzcy.com/wp-content/uploads/2016/01/php-7-version.png" alt="php-7-version"/></a> My next post will be about using <strong>pThreads</strong>.If you have questions or recommendations about PHP 7 , please let me know.</p></div></div><div style="margin-top:3rem"><div id="disqus_thread"></div></div><footer class="BlogPostLayout_footer__2aOsZ"><h3 class="BlogPostLayout_title__3g2FG"><a href="/" context="[object Object]" class=" ">smddzcy | yet another dev</a></h3><div class="
      Bio_Bio__3ifbk
      BlogPostLayout_bio__3d60S
    "><img src="https://pbs.twimg.com/profile_images/781276128673689600/tGOdd3qK_400x400.jpg" alt="Me"/><div><div>software engineer, web enthusiast. shares articles, tutorials and his thoughts on various things.</div><div><a href="https://linkedin.com/in/smddzcy" title="LinkedIn" rel="nofollow noopener noreferrer" target="_blank" style="margin-right:5px">LinkedIn</a>•<a href="https://github.com/smddzcy" title="GitHub" rel="nofollow noopener noreferrer" target="_blank" style="margin:0 5px">GitHub</a>•<a href="https://twitter.com/smddzcy" title="Twitter" rel="nofollow noopener noreferrer" target="_blank" style="margin:0 5px">Twitter</a>•<a href="/cv" title="CV" style="margin:0 5px">CV</a></div></div></div><section class="BlogPostLayout_links__2NwEx"><a class=" " href="/posts/2016-01-26/tutorial-multi-threading-in-php7-pthreads" context="[object Object]">← <!-- -->Multi-Threading in PHP7 w/ pThreads</a></section></footer></article></main></div></div><script>!function(i){function e(e){for(var t,r,n=e[0],o=e[1],a=e[2],u=0,c=[];u<n.length;u++)r=n[u],s[r]&&c.push(s[r][0]),s[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(i[t]=o[t]);for(p&&p(e);c.length;)c.shift()();return l.push.apply(l,a||[]),f()}function f(){for(var e,t=0;t<l.length;t++){for(var r=l[t],n=!0,o=1;o<r.length;o++){var a=r[o];0!==s[a]&&(n=!1)}n&&(l.splice(t--,1),e=d(d.s=r[0]))}return e}var r={},c={11:0},s={11:0},l=[];function d(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.e=function(l){var e=[];c[l]?e.push(c[l]):0!==c[l]&&{1:1,6:1}[l]&&e.push(c[l]=new Promise(function(e,n){for(var t="static/css/"+({}[l]||l)+"."+{1:"5cd5b3d4",2:"31d6cfe0",3:"31d6cfe0",4:"31d6cfe0",5:"31d6cfe0",6:"baadcaa5",7:"31d6cfe0",8:"31d6cfe0",9:"31d6cfe0"}[l]+".chunk.css",o=d.p+t,r=document.getElementsByTagName("link"),a=0;a<r.length;a++){var u=(i=r[a]).getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(u===t||u===o))return e()}var c=document.getElementsByTagName("style");for(a=0;a<c.length;a++){var i;if((u=(i=c[a]).getAttribute("data-href"))===t||u===o)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var t=e&&e.target&&e.target.src||o,r=new Error("Loading CSS chunk "+l+" failed.\n("+t+")");r.request=t,n(r)},f.href=o,document.getElementsByTagName("head")[0].appendChild(f)}).then(function(){c[l]=0}));var r=s[l];if(0!==r)if(r)e.push(r[2]);else{var t=new Promise(function(e,t){r=s[l]=[e,t]});e.push(r[2]=t);var n,o=document.getElementsByTagName("head")[0],a=document.createElement("script");a.charset="utf-8",a.timeout=120,d.nc&&a.setAttribute("nonce",d.nc),a.src=d.p+"static/js/"+({}[l]||l)+"."+{1:"8ab4f4f2",2:"06c9d58c",3:"365f8102",4:"e4d40b03",5:"68d61039",6:"c98bd924",7:"24c78ea3",8:"f912d91a",9:"d438d402"}[l]+".chunk.js",n=function(e){a.onerror=a.onload=null,clearTimeout(u);var t=s[l];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,o=new Error("Loading chunk "+l+" failed.\n("+r+": "+n+")");o.type=r,o.request=n,t[1](o)}s[l]=void 0}};var u=setTimeout(function(){n({type:"timeout",target:a})},12e4);a.onerror=a.onload=n,o.appendChild(a)}return Promise.all(e)},d.m=i,d.c=r,d.d=function(e,t,r){d.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},d.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(t,e){if(1&e&&(t=d(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(d.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)d.d(r,n,function(e){return t[e]}.bind(null,n));return r},d.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(t,"a",t),t},d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},d.p="/",d.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var p=n;f()}([])</script><script src="/static/js/10.924d56a7.chunk.js"></script><script src="/static/js/main.c4946e1a.chunk.js"></script></body></html>